<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="format-detection" content="telephone=no, email=no">
    <title>信道推荐</title>
    <link rel="stylesheet" href="css.css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="swiper.min.css" media="screen" charset="utf-8">
</head>
<body class="page-address-book page-address">
<!--<div class="tips-loading fixed-100 hide">
    <p class="box center-middle">数据加载中</p>
</div>-->
<ul class="add-form">
    <!-- sending receiving -->
    <li class="user-tel">
        <input class="user input" id="reCode" maxlength="20" type="text" placeholder="推荐码">

        <!--<i id="addrBookBtn" class="ico-pos hide">地址簿</i>-->
    </li>
    <li id="bureau" class="select-area cur-sor click-right-arrow">
        <input class="bureau input" type="text" placeholder="国地税" readonly="readonly" onfocus="this.blur();">
    </li>
    <li id="area" class="select-area cur-sor click-right-arrow" style="padding: 1.3rem 0;font-size: 1.4rem;font-weight: 500">
        <input class="area input" style="padding: 0 0" type="text" placeholder="工作地区" readonly="readonly" onfocus="this.blur();">
    </li>

    <li id="company" class="select-area cur-sor click-right-arrow">
        <input class="company input" type="text" placeholder="工作单位" readonly="readonly" onfocus="this.blur();">
    </li>
    <li class="user-tel">
        <input class="user input" id="user_name" maxlength="20" type="text" placeholder="用户姓名">
    </li>
    <li class="user-tel">
        <input class="user input" id="user_id" maxlength="20" type="text" placeholder="用户名">
    </li>
    <li class="user-tel">
        <input class="user input" id="user_tel" maxlength="20" type="text" placeholder="手机号码">
    </li>
</ul>
<button id="saveBtn" class="confirm-single-btn" style="width: 90%;border-radius: 4%;margin: 20px auto" type="button">提交</button>
<!--图片裁剪以及智能识别区域-->
<div id="mask" style="display: none"></div>
<div class="select-roll fixed-100 triple triple1 relative" style="display: none">
    <div class="wrap relative">
        <section class="meta relative"><h2 class="title">国地税选择</h2><a id="close1" class="close ico-cls" href="javascript:void(0)" style="color:#000">X</a></section>
        <div class="content five relative">
            <div class="swiper-container relative">
                <ul class="swiper-wrapper ul1 " style="transform: translate3d(0px, 60px, 0px); transition-duration: 0ms;">
                    <li class="swiper-slide relative" style="height: 60px;"><span>国税局</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>地税局</span></li>
                </ul>
            </div>
        </div>
        <button class="confirm"></button>
    </div>
    <div class="fixed-100 mask"></div>
</div>
<div class="select-roll fixed-100 triple triple3 relative" style="display: none">
    <div class="wrap relative">
        <section class="meta relative"><h2 class="title">工作单位选择</h2><a id="close3" class="close ico-cls" href="javascript:void(0)" style="color:#000">X</a></section>
        <div class="content five relative">
            <div class="swiper-container relative">
                <ul class="swiper-wrapper ul3 relative" style="transform: translate3d(0px, 60px, 0px); transition-duration: 0ms;">
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位1</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位2</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位3</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位4</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位5</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位6</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位7</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位8</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位9</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位10</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位11</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位12</span></li>
                    <li class="swiper-slide relative" style="height: 60px;"><span>单位13</span></li>
                </ul>
            </div>
        </div>
        <button class="confirm"></button>
    </div>
    <div class="fixed-100 mask"></div>
</div>
</body>
<script type="text/javascript" src="zepto.min.js"></script>
<script type="text/javascript" src="swiper.min.js"></script>
<script type="text/javascript">


    var mySwiper = new Swiper ('.swiper-container', {
        direction: 'vertical',
        freeMode : true
//        freeModeMomentumRatio : 1,
    });

    $('#bureau').click(function () {
        $('#mask').show();
        $('.triple1').show(300);
    });
    /*    $('#area').click(function () {
     $('.triple2').show();
     });*/
    $('#company').click(function () {
        $('#mask').show();
        $('.triple3').show(300);
    });
    $('#close1').click(function () {
        $('#mask').hide();
        $('.triple1').hide()
    });
/*    $('#close2').click(function () {
        $('.triple2').hide()
    });*/
    $('#close3').click(function () {
        $('#mask').hide();
        $('.triple3').hide()
    });


    $('.ul1 .swiper-slide span').click(function () {
        $('.bureau').val($(this).text());
        $('#mask').hide();
        $('.triple').hide()
    });
/*    $('.ul2 .swiper-slide span').click(function () {
        $('.area').val($(this).text());
        $('.triple').hide()
    });*/
    $('.ul3 .swiper-slide span').click(function () {
        $('.company').val($(this).text());
        $('#mask').hide();
        $('.triple').hide()
    });

    $('#saveBtn').click(function () {
        var re_code=$('#reCode').val(),
            bureau=$('.bureau').val(),
            area=$('#area').text(),
            company=$('.company').val(),
            user_name=$('#user_name').val(),
            user_id=$('#user_id').val(),
            user_tel=$('#user_tel').val();

        var str =re_code+'/'+bureau+'/'+area+'/'+company+'/'+user_name+'/'+user_id+'/'+user_tel;
        alert(str)
    })
</script>
<!--城市联动-->
<script src="picker.min.js"></script>
<script src="city.js"></script>
<script type="text/javascript">
    var nameEl = document.getElementById('area');

    var first = []; /* 省，直辖市 */
    var second = []; /* 市 */
    var third = []; /* 镇 */

    var selectedIndex = [0, 0, 0]; /* 默认选中的地区 */

    var checked = [0, 0, 0]; /* 已选选项 */

    function creatList(obj, list){
        obj.forEach(function(item, index, arr){
            var temp = new Object();
            temp.text = item.name;
            temp.value = index;
            list.push(temp);
        })
    }

    creatList(city, first);

    if (city[selectedIndex[0]].hasOwnProperty('sub')) {
        creatList(city[selectedIndex[0]].sub, second);
    } else {
        second = [{text: '', value: 0}];
    }

    if (city[selectedIndex[0]].sub[selectedIndex[1]].hasOwnProperty('sub')) {
        creatList(city[selectedIndex[0]].sub[selectedIndex[1]].sub, third);
    } else {
        third = [{text: '', value: 0}];
    }

    var picker = new Picker({
        data: [first, second, third],
        selectedIndex: selectedIndex,
        title: '地址选择'
    });

    picker.on('picker.select', function (selectedVal, selectedIndex) {
        var text1 = first[selectedIndex[0]].text;
        var text2 = second[selectedIndex[1]].text;
        var text3 = third[selectedIndex[2]] ? third[selectedIndex[2]].text : '';

        nameEl.innerText = text1 + ' ' + text2 + ' ' + text3;
    });

    picker.on('picker.change', function (index, selectedIndex) {
        if (index === 0){
            firstChange();
        } else if (index === 1) {
            secondChange();
        }

        function firstChange() {
            second = [];
            third = [];
            checked[0] = selectedIndex;
            var firstCity = city[selectedIndex];
            if (firstCity.hasOwnProperty('sub')) {
                creatList(firstCity.sub, second);

                var secondCity = city[selectedIndex].sub[0]
                if (secondCity.hasOwnProperty('sub')) {
                    creatList(secondCity.sub, third);
                } else {
                    third = [{text: '', value: 0}];
                    checked[2] = 0;
                }
            } else {
                second = [{text: '', value: 0}];
                third = [{text: '', value: 0}];
                checked[1] = 0;
                checked[2] = 0;
            }

            picker.refillColumn(1, second);
            picker.refillColumn(2, third);
            picker.scrollColumn(1, 0)
            picker.scrollColumn(2, 0)
        }

        function secondChange() {
            third = [];
            checked[1] = selectedIndex;
            var first_index = checked[0];
            if (city[first_index].sub[selectedIndex].hasOwnProperty('sub')) {
                var secondCity = city[first_index].sub[selectedIndex];
                creatList(secondCity.sub, third);
                picker.refillColumn(2, third);
                picker.scrollColumn(2, 0)
            } else {
                third = [{text: '', value: 0}];
                checked[2] = 0;
                picker.refillColumn(2, third);
                picker.scrollColumn(2, 0)
            }
        }

    });

    picker.on('picker.valuechange', function (selectedVal, selectedIndex) {
        console.log(selectedVal);
        console.log(selectedIndex);
    });

    nameEl.addEventListener('click', function () {
        picker.show();
    });
</script>
</body>
</html>
